<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="534px" preserveAspectRatio="none" style="width:655px;height:534px;" version="1.1" viewBox="0 0 655 534" width="655px" zoomAndPan="magnify"><defs><filter height="300%" id="f6xnd3nonksta" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#f6xnd3nonksta)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="236.5" y="200"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="236.5" x2="353.5" y1="226.2969" y2="226.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="97" x="246.5" y="217.9951">Lane following</text><rect fill="#FEFECE" filter="url(#f6xnd3nonksta)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="166" y="311"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="166" x2="300" y1="337.2969" y2="337.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="176" y="328.9951">Lane change left</text><rect fill="#FEFECE" filter="url(#f6xnd3nonksta)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="335" y="311"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="335" x2="479" y1="337.2969" y2="337.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="345" y="328.9951">Lane change right</text><rect fill="#FEFECE" filter="url(#f6xnd3nonksta)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="54" x="147" y="200"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="147" x2="201" y1="226.2969" y2="226.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="157" y="217.9951">Initial</text><polygon fill="#FBFB77" filter="url(#f6xnd3nonksta)" points="6,422,6,522.7969,302,522.7969,302,432,292,422,6,422" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FBFB77" points="6,422,6,522.7969,302,522.7969,302,432,292,422,187.216,422,218.876,361.046,179.216,422,6,422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="292" x2="292" y1="422" y2="432"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="302" x2="292" y1="432" y2="432"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="12" y="439.0669">Once state is entered it will generate a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="12" y="454.1997">path for 3 seconds which the car will follow.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="275" x="12" y="469.3325">No futher updates to this path will be done.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="16" y="484.4653"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="12" y="499.5981">Once the car reaches the end of this path</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="12" y="514.731">the state will change to Lane following.</text><polygon fill="#FBFB77" filter="url(#f6xnd3nonksta)" points="337,422,337,522.7969,633,522.7969,633,432,623,422,337,422" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FBFB77" points="337,422,337,522.7969,633,522.7969,633,432,623,422,460.154,422,420.945,361.046,452.154,422,337,422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="623" x2="623" y1="422" y2="432"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="633" x2="623" y1="432" y2="432"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="343" y="439.0669">Once state is entered it will generate a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="343" y="454.1997">path for 3 seconds which the car will follow.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="275" x="343" y="469.3325">No futher updates to this path will be done.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="347" y="484.4653"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="343" y="499.5981">Once the car reaches the end of this path</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="343" y="514.731">the state will change to Lane following.</text><polygon fill="#FBFB77" filter="url(#f6xnd3nonksta)" points="29,8,29,139.0625,561,139.0625,561,18,551,8,29,8" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FBFB77" points="29,8,29,139.0625,291,139.0625,295,199.72,299,139.0625,561,139.0625,561,18,551,8,29,8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="551" x2="551" y1="8" y2="18"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="561" x2="551" y1="18" y2="18"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="505" x="35" y="25.0669">This state generates multiple paths in its current lane (different target speeds).</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="360" x="35" y="40.1997">The best path according to a fitness function is selected.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="511" x="35" y="55.3325">The fitness function and path generation accounts for the surrounding state and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="35" y="70.4653">the state of the ego vehicle.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="39" y="85.5981"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="376" x="35" y="100.731">If the selected path has a target speed below a threshold it</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="438" x="35" y="115.8638">will check if it is possible to change state to either lane change state.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="400" x="35" y="130.9966">This check includes checking if the lane next to our car is clear.</text><ellipse cx="52" cy="225" fill="#000000" filter="url(#f6xnd3nonksta)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><!--link *start to init--><path d="M62.4017,225 C79.7966,225 115.474,225 141.828,225 " fill="none" id="*start-init" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="146.967,225,137.967,221,141.967,225,137.967,229,146.967,225" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="80.5" y="218.0669">Startup</text><!--link init to lane--><path d="M201.414,225 C211.272,225 221.13,225 230.988,225 " fill="none" id="init-lane" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="236.143,225,227.143,221,231.143,225,227.143,229,236.143,225" style="stroke: #A80036; stroke-width: 1.0;"/><!--link lane to changeL--><path d="M270.436,250.191 C258.67,266.701 245.982,288.654 238.037,306.088 " fill="none" id="lane-changeL" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="235.927,310.877,243.2158,304.2533,237.9427,306.3013,235.8947,301.0282,235.927,310.877" style="stroke: #A80036; stroke-width: 1.0;"/><!--link changeL to lane--><path d="M258.151,310.877 C270.054,294.381 282.76,272.43 290.602,254.984 " fill="none" id="changeL-lane" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="292.68,250.191,285.4303,256.8575,290.6913,254.7785,292.7703,260.0394,292.68,250.191" style="stroke: #A80036; stroke-width: 1.0;"/><!--link lane to changeR--><path d="M309.052,250.191 C324.017,267.125 347.15,289.784 367.408,307.42 " fill="none" id="lane-changeR" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="371.418,310.877,367.2124,301.9712,367.6307,307.6126,361.9893,308.0309,371.418,310.877" style="stroke: #A80036; stroke-width: 1.0;"/><!--link changeR to lane--><path d="M393.643,310.877 C378.843,293.958 355.726,271.3 335.335,253.651 " fill="none" id="changeR-lane" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="331.296,250.191,335.5286,259.084,335.0932,253.4439,340.7333,253.0085,331.296,250.191" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml

state "Lane following" as lane
state "Lane change left" as changeL
state "Lane change right" as changeR
state "Initial" as init

note bottom of changeL
Once state is entered it will generate a
path for 3 seconds which the car will follow.
No futher updates to this path will be done.

Once the car reaches the end of this path
the state will change to Lane following.
endnote

note bottom of changeR
Once state is entered it will generate a
path for 3 seconds which the car will follow.
No futher updates to this path will be done.

Once the car reaches the end of this path
the state will change to Lane following.
endnote

note top of lane
This state generates multiple paths in its current lane (different target speeds).
The best path according to a fitness function is selected.
The fitness function and path generation accounts for the surrounding state and
the state of the ego vehicle.

If the selected path has a target speed below a threshold it
will check if it is possible to change state to either lane change state.
This check includes checking if the lane next to our car is clear.
endnote

[*] -> init: Startup
init -> lane

lane - -> changeL
changeL - -> lane

lane - -> changeR
changeR - -> lane

@enduml

PlantUML version 1.2017.15(Mon Jul 03 18:45:34 CEST 2017)
(EPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_151-8u151-b12-0ubuntu0.16.04.2-b12
Operating System: Linux
OS Version: 4.10.0-42-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>